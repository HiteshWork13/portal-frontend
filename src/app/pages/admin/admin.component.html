<ng-container *ngIf="adminTableJSON">
  <app-table (onRowClick)="handleAdminRowClick($event)" [Config]="adminTableJSON" [Data]="adminList"
    (header_addClick)="openModal(temp, 'add', '')" [TotalItems]="totalData" [PageSize]="PageSize" [sorting]="tabsorting"
    (sortTableColumn)="sortAdminTable($event)">
  </app-table>
</ng-container>

<div *ngIf="isSubAdminVisible" style="margin: 25px 0 0 0">
  <app-sub-admin [selectedAdminId]="selectedAdminIdForSubAdmin"
    (onViewAccountOption)="handleAccounts({ id: $event['id'] })" (close)="isSubAdminVisible = false"></app-sub-admin>
</div>

<div *ngIf="isAccountsVisible" style="margin: 25px 0 0 0">
  <app-user [selectedAdminId]="selectedAdminIdForAccounts" (close)="isAccountsVisible = false"></app-user>
</div>

<ng-template #actionTemplate let-column="column" let-row="row" let-rowIndex="rowIndex" let-columnIndex="columnIndex">
  <div style="position: relative" class="text-center">

    <button type="button" nz-button nz-dropdown nzTrigger="click" [nzDropdownMenu]="actionMenu"
      nzPlacement="bottomRight" style="cursor: pointer" (click)="$event.stopPropagation()">
      <i nz-icon nzType="ellipsis"></i>
    </button>

    <nz-dropdown-menu #actionMenu="nzDropdownMenu">
      <ul nz-menu class="wi-action-menu">
        <li nz-menu-item role="menuitem">
          <a class="dropdown-item" (click)="handleSubAdmin(row)">Sub admins</a>
        </li>
        <li nz-menu-item role="menuitem">
          <a class="dropdown-item" (click)="openModal(temp, 'edit', row)">Edit</a>
        </li>
        <li nz-menu-item role="menuitem">
          <a class="dropdown-item" (click)="showDeleteConfirm(row.id)">Delete</a>
        </li>
      </ul>
    </nz-dropdown-menu>
  </div>
</ng-template>

<ng-template #statusTemplate let-column="column" let-row="row" let-rowIndex="rowIndex" let-columnIndex="columnIndex">
  <!-- <nz-tag *ngIf="row[column.property] == 0" [nzColor]="'#E23E31'">Inactive</nz-tag>
  <nz-tag *ngIf="row[column.property] == 1" [nzColor]="'#4AAC4E'">Active</nz-tag> -->
  <nz-switch nzSize="small" [ngModel]="row[column.property]"
    (ngModelChange)="statusChanged($event,row,column.property)">
  </nz-switch>
</ng-template>

<ng-template #temp>
  <form nz-form nzLayout="vertical" id="addAdminForm" [formGroup]="adminForm">
    <nz-form-item>
      <nz-form-label>Admin Name</nz-form-label>
      <nz-form-control nzErrorTip="Enter a valid admin name">
        <input nz-input trim="blur" formControlName="username" maxlength="80" #adminName
          placeholder="Enter admin name" />
      </nz-form-control>
    </nz-form-item>
    <nz-form-item *ngIf="mode == 'add'">
      <nz-form-label>Admin Email</nz-form-label>
      <nz-form-control nzErrorTip="Enter a valid admin email">
        <input nz-input trim="blur" formControlName="email" maxlength="80" placeholder="Enter email address" />
      </nz-form-control>
    </nz-form-item>
    <nz-form-item *ngIf="mode == 'add'">
      <nz-form-label nzFor="newPassword" class="text-black">Password
      </nz-form-label>
      <nz-form-control [nzErrorTip]="newPasswordRef">
        <nz-input-group [nzPrefix]="prefixLock">
          <input id="myinputbox" type="password" nz-input formControlName="password" placeholder="Enter new password"
            autofocus />
        </nz-input-group>
        <ng-template #newPasswordRef>
          Password is not valid
          <i class="fa fa-info-circle float-right pt-1" nzPopoverPlacement="bottom" nz-popover nzType="primary"
            nzPopoverTitle="Password Criteria" [nzPopoverContent]="popoverContent"></i>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
  </form>
</ng-template>
<ng-template #prefixLock><i nz-icon nzType="lock"></i></ng-template>

<ng-template #popoverContent>
  <ul class="p-l-20">
    <li>Alpahnumeric and at least 8 characters long <br /></li>
    <li>At least one uppercase letter <br /></li>
    <li>
      At least one of these characters ( @ / # / $ / % / ^ / & / + / = )<br />
    </li>
    <li>Must not contain spaces</li>
  </ul>
</ng-template>